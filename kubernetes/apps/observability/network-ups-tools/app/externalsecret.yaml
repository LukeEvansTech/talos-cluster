---
# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/external-secrets.io/externalsecret_v1.json
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: network-ups-tools
spec:
  refreshInterval: 5m
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    name: network-ups-tools-secret
    template:
      data:
        UPS_MAIN_HOSTNAME: "{{ .UPS_MAIN_HOSTNAME }}"
        UPS_MAIN_COMMUNITY: "{{ .UPS_MAIN_COMMUNITY }}"
        UPS_COMMS_HOSTNAME: "{{ .UPS_COMMS_HOSTNAME }}"
        UPS_COMMS_USERNAME: "{{ .UPS_COMMS_USERNAME }}"
        UPS_COMMS_PASSWORD: "{{ .UPS_COMMS_PASSWORD }}"
        UPS_COMMS_COMMUNITY: "{{ .UPS_COMMS_COMMUNITY }}"
  data:
    - secretKey: UPS_MAIN_HOSTNAME
      remoteRef:
        key: cr-ups-main
        property: APC_HOSTNAME
    - secretKey: UPS_MAIN_COMMUNITY
      remoteRef:
        key: cr-ups-main
        property: APC_COMMUNITY
    - secretKey: UPS_COMMS_HOSTNAME
      remoteRef:
        key: cr-ups-comms
        property: APC_HOSTNAME
    - secretKey: UPS_COMMS_USERNAME
      remoteRef:
        key: cr-ups-comms
        property: APC_USERNAME
    - secretKey: UPS_COMMS_PASSWORD
      remoteRef:
        key: cr-ups-comms
        property: APC_PASSWORD
    - secretKey: UPS_COMMS_COMMUNITY
      remoteRef:
        key: cr-ups-comms
        property: APC_COMMUNITY
