---
# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/external-secrets.io/externalsecret_v1.json
# ExternalSecret for APC UPS Network Card credentials
#
# This pulls credentials from 1Password for your APC UPS.
#
# Required fields in 1Password (cr-ups-main):
#   APC_HOSTNAME    - Hostname or IP address of the APC Network Card
#   APC_COMMUNITY   - SNMP community string (optional, defaults to "public")
#
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: network-ups-tools
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    name: network-ups-tools-secret
    template:
      data:
        # PORT is the UPS hostname/IP for snmp-ups driver
        PORT: "{{ .APC_HOSTNAME }}"
        # API_PASSWORD for upsmon authentication
        API_PASSWORD: "secret"
  data:
    - secretKey: APC_HOSTNAME
      remoteRef:
        key: cr-ups-main
        property: APC_HOSTNAME
